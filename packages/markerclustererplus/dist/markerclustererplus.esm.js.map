{"version":3,"file":"markerclustererplus.esm.js","sources":["../src/overlay-view-safe.ts","../src/cluster-icon.ts","../src/cluster.ts","../src/markerclusterer.ts","../src/index.ts"],"sourcesContent":["/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface OverlayViewSafe extends google.maps.OverlayView {}\n\n/**\n * Extends an object's prototype by another's.\n *\n * @param type1 The Type to be extended.\n * @param type2 The Type to extend with.\n * @ignore\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction extend(type1: any, type2: any): void {\n  // eslint-disable-next-line prefer-const\n  for (let property in type2.prototype) {\n    type1.prototype[property] = type2.prototype[property];\n  }\n}\n\n/**\n * @ignore\n */\nexport class OverlayViewSafe {\n  constructor() {\n    // MarkerClusterer implements google.maps.OverlayView interface. We use the\n    // extend function to extend MarkerClusterer with google.maps.OverlayView\n    // because it might not always be available when the code is defined so we\n    // look for it at the last possible moment. If it doesn't exist now then\n    // there is no point going ahead :)\n    extend(OverlayViewSafe, google.maps.OverlayView);\n  }\n}\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This class represents the object for values in the `styles` array passed\n * to the {@link MarkerClusterer} constructor. The element in this array that is used to\n * style the cluster icon is determined by calling the `calculator` function.\n */\nimport { Cluster } from \"./cluster\";\nimport { OverlayViewSafe } from \"./overlay-view-safe\";\n\n/**\n *\n * @hidden\n */\nfunction toCssText(styles: { [key: string]: string }): string {\n  return Object.keys(styles)\n    .reduce((acc, key) => {\n      if (styles[key]) {\n        acc.push(key + \":\" + styles[key]);\n      }\n      return acc;\n    }, [])\n    .join(\";\");\n}\n\n/**\n *\n * @hidden\n */\nfunction coercePixels(pixels: number): string {\n  return pixels ? pixels + \"px\" : undefined;\n}\n\nexport interface ClusterIconStyle {\n  /** The URL of the cluster icon image file. If not set, img element will not be created */\n  url?: string;\n  /** The name of the CSS class defining styles for the cluster markers. */\n  className?: string;\n  /** Height The display height (in pixels) of the cluster icon. Required. */\n  height: number;\n  /** Width The display width (in pixels) of the cluster icon. Required. */\n  width: number;\n  /**\n   * The position (in pixels) from the center of the cluster icon to\n   * where the text label is to be centered and drawn. The format is `[yoffset, xoffset]`\n   * where `yoffset` increases as you go down from center and `xoffset`\n   * increases to the right of center. The default is `[0, 0]`.\n   */\n  anchorText?: [number, number];\n  /**\n   * The anchor position (in pixels) of the cluster icon. This is the\n   * spot on the cluster icon that is to be aligned with the cluster position. The format is\n   * `[yoffset, xoffset]` where `yoffset` increases as you go down and\n   * `xoffset` increases to the right of the top-left corner of the icon. The default\n   * anchor position is the center of the cluster icon.\n   */\n  anchorIcon?: [number, number];\n  /**\n   * The color of the label text shown on the cluster icon.\n   * @default `\"black\"`\n   */\n  textColor?: string;\n  /** The size (in pixels) of the label text shown on the cluster icon.\n   * @default `11`\n   */\n  textSize?: number;\n\n  /** The line height (in pixels) of the label text shown on the cluster icon.\n   * @default the same as cluster icon height\n   */\n  textLineHeight?: number;\n  /**\n   * The value of the CSS `text-decoration`\n   * property for the label text shown on the cluster icon.\n   *\n   * @default `\"none\"`\n   */\n  textDecoration?: string;\n  /**\n   * The value of the CSS `font-weight`\n   * property for the label text shown on the cluster icon.\n   *\n   *  @default `\"bold\"`\n   */\n  fontWeight?: string;\n  /**\n   *  The value of the CSS `font-style`\n   *  property for the label text shown on the cluster icon.\n   *\n   *  @default `\"normal\"`\n   */\n  fontStyle?: string;\n  /**\n   *  The value of the CSS `font-family`\n   *  property for the label text shown on the cluster icon.\n   *  @default `\"Arial,sans-serif\"`\n   */\n  fontFamily?: string;\n  /**\n   * The position of the cluster icon image\n   * within the image defined by `url`. The format is `\"xpos ypos\"`\n   * (the same format as for the CSS `background-position` property). You must set\n   * this property appropriately when the image defined by `url` represents a sprite\n   * containing multiple images. Note that the position <i>must</i> be specified in px units.\n   *\n   * @default `\"0 0\"`\n   */\n  backgroundPosition?: string;\n}\n\n/**\n * @description This is an object containing general information about a cluster icon. This is\n *  the object that a `calculator` function returns.\n */\nexport interface ClusterIconInfo {\n  /**\n   * The text of the label to be shown on the cluster icon.\n   */\n  text: string;\n  /**\n   * The index plus 1 of the element in the `styles`\n   */\n  index: number;\n  /**\n   * The tooltip to display when the mouse moves over the cluster icon.\n   * If this value is `undefined` or `\"\"`, `title` is set to the\n   * value of the `title` property passed to the MarkerClusterer.\n   */\n  title: string;\n}\n\n/**\n * A cluster icon.\n */\nexport class ClusterIcon extends OverlayViewSafe {\n  private className_: string;\n  private center_: google.maps.LatLng = null;\n  private div_: HTMLDivElement = null;\n  private sums_: ClusterIconInfo = null;\n  private visible_ = false;\n\n  private style: ClusterIconStyle = null;\n\n  private anchorText_: [number, number];\n  private anchorIcon_: [number, number];\n\n  private boundsChangedListener_: google.maps.MapsEventListener;\n\n  /**\n   * @param cluster_ The cluster with which the icon is to be associated.\n   * @param styles_ An array of {@link ClusterIconStyle} defining the cluster icons\n   *  to use for various cluster sizes.\n   */\n  constructor(private cluster_: Cluster, private styles_: ClusterIconStyle[]) {\n    super();\n\n    this.setMap(cluster_.getMap()); // Note: this causes onAdd to be called\n  }\n\n  /**\n   * Adds the icon to the DOM.\n   */\n  onAdd(): void {\n    let cMouseDownInCluster: boolean;\n    let cDraggingMapByCluster: boolean;\n\n    const mc = this.cluster_.getMarkerClusterer();\n\n    const [major, minor] = google.maps.version.split(\".\");\n\n    const gmVersion = parseInt(major, 10) * 100 + parseInt(minor, 10);\n\n    this.div_ = document.createElement(\"div\");\n    if (this.visible_) {\n      this.show();\n    }\n\n    this.getPanes().overlayMouseTarget.appendChild(this.div_);\n\n    // Fix for Issue 157\n    this.boundsChangedListener_ = google.maps.event.addListener(\n      this.getMap(),\n      \"bounds_changed\",\n      function() {\n        cDraggingMapByCluster = cMouseDownInCluster;\n      }\n    );\n\n    google.maps.event.addDomListener(this.div_, \"mousedown\", () => {\n      cMouseDownInCluster = true;\n      cDraggingMapByCluster = false;\n    });\n\n    // March 1, 2018: Fix for this 3.32 exp bug, https://issuetracker.google.com/issues/73571522\n    // But it doesn't work with earlier releases so do a version check.\n    if (gmVersion >= 332) {\n      // Ugly version-dependent code\n      google.maps.event.addDomListener(this.div_, \"touchstart\", e => {\n        e.stopPropagation();\n      });\n    }\n\n    google.maps.event.addDomListener(this.div_, \"click\", e => {\n      cMouseDownInCluster = false;\n      if (!cDraggingMapByCluster) {\n        /**\n         * This event is fired when a cluster marker is clicked.\n         * @name MarkerClusterer#click\n         * @param {Cluster} c The cluster that was clicked.\n         * @event\n         */\n        google.maps.event.trigger(mc, \"click\", this.cluster_);\n        google.maps.event.trigger(mc, \"clusterclick\", this.cluster_); // deprecated name\n\n        // The default click handler follows. Disable it by setting\n        // the zoomOnClick property to false.\n        if (mc.getZoomOnClick()) {\n          // Zoom into the cluster.\n          const mz = mc.getMaxZoom();\n          const theBounds = this.cluster_.getBounds();\n          (mc.getMap() as google.maps.Map).fitBounds(theBounds);\n          // There is a fix for Issue 170 here:\n          setTimeout(function() {\n            (mc.getMap() as google.maps.Map).fitBounds(theBounds);\n            // Don't zoom beyond the max zoom level\n            if (mz !== null && mc.getMap().getZoom() > mz) {\n              mc.getMap().setZoom(mz + 1);\n            }\n          }, 100);\n        }\n\n        // Prevent event propagation to the map:\n        e.cancelBubble = true;\n        if (e.stopPropagation) {\n          e.stopPropagation();\n        }\n      }\n    });\n\n    google.maps.event.addDomListener(this.div_, \"mouseover\", () => {\n      /**\n       * This event is fired when the mouse moves over a cluster marker.\n       * @name MarkerClusterer#mouseover\n       * @param {Cluster} c The cluster that the mouse moved over.\n       * @event\n       */\n      google.maps.event.trigger(mc, \"mouseover\", this.cluster_);\n    });\n\n    google.maps.event.addDomListener(this.div_, \"mouseout\", () => {\n      /**\n       * This event is fired when the mouse moves out of a cluster marker.\n       * @name MarkerClusterer#mouseout\n       * @param {Cluster} c The cluster that the mouse moved out of.\n       * @event\n       */\n      google.maps.event.trigger(mc, \"mouseout\", this.cluster_);\n    });\n  }\n\n  /**\n   * Removes the icon from the DOM.\n   */\n  onRemove(): void {\n    if (this.div_ && this.div_.parentNode) {\n      this.hide();\n      google.maps.event.removeListener(this.boundsChangedListener_);\n      google.maps.event.clearInstanceListeners(this.div_);\n      this.div_.parentNode.removeChild(this.div_);\n      this.div_ = null;\n    }\n  }\n\n  /**\n   * Draws the icon.\n   */\n  draw(): void {\n    if (this.visible_) {\n      const pos = this.getPosFromLatLng_(this.center_);\n      this.div_.style.top = pos.y + \"px\";\n      this.div_.style.left = pos.x + \"px\";\n    }\n  }\n\n  /**\n   * Hides the icon.\n   */\n  hide(): void {\n    if (this.div_) {\n      this.div_.style.display = \"none\";\n    }\n    this.visible_ = false;\n  }\n\n  /**\n   * Positions and shows the icon.\n   */\n  show(): void {\n    if (this.div_) {\n      this.div_.className = this.className_;\n      this.div_.style.cssText = this.createCss_(\n        this.getPosFromLatLng_(this.center_)\n      );\n\n      this.div_.innerHTML =\n        (this.style.url ? this.getImageElementHtml() : \"\") +\n        this.getLabelDivHtml();\n\n      if (typeof this.sums_.title === \"undefined\" || this.sums_.title === \"\") {\n        this.div_.title = this.cluster_.getMarkerClusterer().getTitle();\n      } else {\n        this.div_.title = this.sums_.title;\n      }\n      this.div_.style.display = \"\";\n    }\n    this.visible_ = true;\n  }\n\n  private getLabelDivHtml(): string {\n    const mc = this.cluster_.getMarkerClusterer();\n    const ariaLabel = mc.ariaLabelFn(this.sums_.text);\n\n    const divStyle: { [key: string]: string } = {\n      position: \"absolute\",\n      top: coercePixels(this.anchorText_[0]),\n      left: coercePixels(this.anchorText_[1]),\n      color: this.style.textColor,\n      \"font-size\": coercePixels(this.style.textSize),\n      \"font-family\": this.style.fontFamily,\n      \"font-weight\": this.style.fontWeight,\n      \"font-style\": this.style.fontStyle,\n      \"text-decoration\": this.style.textDecoration,\n      \"text-align\": \"center\",\n      width: coercePixels(this.style.width),\n      \"line-height\": coercePixels(this.style.textLineHeight)\n    };\n\n    return `\n<div aria-label=\"${ariaLabel}\" style=\"${toCssText(divStyle)}\" tabindex=\"0\">\n  <span aria-hidden=\"true\">${this.sums_.text}</span>\n</div>\n`;\n  }\n\n  private getImageElementHtml(): string {\n    // NOTE: values must be specified in px units\n    const bp = (this.style.backgroundPosition || \"0 0\").split(\" \");\n    const spriteH = parseInt(bp[0].replace(/^\\s+|\\s+$/g, \"\"), 10);\n    const spriteV = parseInt(bp[1].replace(/^\\s+|\\s+$/g, \"\"), 10);\n\n    let dimensions: { [key: string]: string } = {};\n\n    if (this.cluster_.getMarkerClusterer().getEnableRetinaIcons()) {\n      dimensions = {\n        width: coercePixels(this.style.width),\n        height: coercePixels(this.style.height)\n      };\n    } else {\n      const [Y1, X1, Y2, X2] = [\n        -1 * spriteV,\n        -1 * spriteH + this.style.width,\n        -1 * spriteV + this.style.height,\n        -1 * spriteH\n      ];\n      dimensions = {\n        clip: `rect(${Y1}px, ${X1}px, ${Y2}px, ${X2}px)`\n      };\n    }\n\n    const cssText = toCssText({\n      position: \"absolute\",\n      top: coercePixels(spriteV),\n      left: coercePixels(spriteH),\n      ...dimensions\n    });\n\n    return `<img alt=\"${this.sums_.text}\" aria-hidden=\"true\" src=\"${this.style.url}\" style=\"${cssText}\"/>`;\n  }\n\n  /**\n   * Sets the icon styles to the appropriate element in the styles array.\n   *\n   * @ignore\n   * @param sums The icon label text and styles index.\n   */\n  useStyle(sums: ClusterIconInfo): void {\n    this.sums_ = sums;\n    let index = Math.max(0, sums.index - 1);\n    index = Math.min(this.styles_.length - 1, index);\n    this.style = this.styles_[index];\n\n    this.anchorText_ = this.style.anchorText || [0, 0];\n    this.anchorIcon_ = this.style.anchorIcon || [\n      Math.floor(this.style.height / 2),\n      Math.floor(this.style.width / 2)\n    ];\n\n    this.className_ =\n      this.cluster_.getMarkerClusterer().getClusterClass() +\n      \" \" +\n      (this.style.className || \"cluster-\" + index);\n  }\n\n  /**\n   * Sets the position at which to center the icon.\n   *\n   * @param center The latlng to set as the center.\n   */\n  setCenter(center: google.maps.LatLng): void {\n    this.center_ = center;\n  }\n\n  /**\n   * Creates the `cssText` style parameter based on the position of the icon.\n   *\n   * @param pos The position of the icon.\n   * @return The CSS style text.\n   */\n  private createCss_(pos: google.maps.Point): string {\n    return toCssText({\n      \"z-index\": `${this.cluster_.getMarkerClusterer().getZIndex()}`,\n      top: coercePixels(pos.y),\n      left: coercePixels(pos.x),\n      width: coercePixels(this.style.width),\n      height: coercePixels(this.style.height),\n      cursor: \"pointer\",\n      position: \"absolute\",\n      \"-webkit-user-select\": \"none\",\n      \"-khtml-user-select\": \"none\",\n      \"-moz-user-select\": \"none\",\n      \"-o-user-select\": \"none\",\n      \"user-select\": \"none\"\n    });\n  }\n\n  /**\n   * Returns the position at which to place the DIV depending on the latlng.\n   *\n   * @param latlng The position in latlng.\n   * @return The position in pixels.\n   */\n  private getPosFromLatLng_(latlng: google.maps.LatLng): google.maps.Point {\n    const pos = this.getProjection().fromLatLngToDivPixel(latlng);\n    pos.x = Math.floor(pos.x - this.anchorIcon_[1]);\n    pos.y = Math.floor(pos.y - this.anchorIcon_[0]);\n    return pos;\n  }\n}\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MarkerClusterer, ClusterAugmentedMarker } from \"./markerclusterer\";\nimport { ClusterIcon } from \"./cluster-icon\";\n\n/**\n * Creates a single cluster that manages a group of proximate markers.\n *  Used internally, do not call this constructor directly.\n */\nexport class Cluster {\n  private map_ = this.markerClusterer_.getMap() as google.maps.Map;\n  private minClusterSize_: number = this.markerClusterer_.getMinimumClusterSize();\n  private averageCenter_: boolean = this.markerClusterer_.getAverageCenter();\n  private markers_: ClusterAugmentedMarker[] = []; // TODO: type;\n  private center_: google.maps.LatLng = null;\n  private bounds_: google.maps.LatLngBounds = null;\n  private clusterIcon_ = new ClusterIcon(\n    this,\n    this.markerClusterer_.getStyles()\n  );\n\n  /**\n   *\n   * @param markerClusterer_ The `MarkerClusterer` object with which this\n   *  cluster is associated.\n   */\n  constructor(private markerClusterer_: MarkerClusterer) {}\n\n  /**\n   * Returns the number of markers managed by the cluster. You can call this from\n   * a `click`, `mouseover`, or `mouseout` event handler for the `MarkerClusterer` object.\n   *\n   * @return The number of markers in the cluster.\n   */\n  public getSize(): number {\n    return this.markers_.length;\n  }\n\n  /**\n   * Returns the array of markers managed by the cluster. You can call this from\n   * a `click`, `mouseover`, or `mouseout` event handler for the `MarkerClusterer` object.\n   *\n   * @return The array of markers in the cluster.\n   */\n  public getMarkers(): google.maps.Marker[] {\n    return this.markers_;\n  }\n\n  /**\n   * Returns the center of the cluster. You can call this from\n   * a `click`, `mouseover`, or `mouseout` event handler\n   * for the `MarkerClusterer` object.\n   *\n   * @return The center of the cluster.\n   */\n  public getCenter(): google.maps.LatLng {\n    return this.center_;\n  }\n\n  /**\n   * Returns the map with which the cluster is associated.\n   *\n   * @return The map.\n   * @ignore\n   */\n  public getMap(): google.maps.Map {\n    return this.map_;\n  }\n\n  /**\n   * Returns the `MarkerClusterer` object with which the cluster is associated.\n   *\n   * @return The associated marker clusterer.\n   * @ignore\n   */\n  public getMarkerClusterer(): MarkerClusterer {\n    return this.markerClusterer_;\n  }\n\n  /**\n   * Returns the bounds of the cluster.\n   *\n   * @return the cluster bounds.\n   * @ignore\n   */\n  public getBounds(): google.maps.LatLngBounds {\n    const bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n    const markers = this.getMarkers();\n    for (let i = 0; i < markers.length; i++) {\n      bounds.extend(markers[i].getPosition());\n    }\n    return bounds;\n  }\n\n  /**\n   * Removes the cluster from the map.\n   *\n   * @ignore\n   */\n  public remove(): void {\n    this.clusterIcon_.setMap(null);\n    this.markers_ = [];\n    delete this.markers_;\n  }\n\n  /**\n   * Adds a marker to the cluster.\n   *\n   * @param marker The marker to be added.\n   * @return True if the marker was added.\n   * @ignore\n   */\n  public addMarker(\n    marker: google.maps.Marker & { isAdded?: boolean }\n  ): boolean {\n    if (this.isMarkerAlreadyAdded_(marker)) {\n      return false;\n    }\n\n    if (!this.center_) {\n      this.center_ = marker.getPosition();\n      this.calculateBounds_();\n    } else {\n      if (this.averageCenter_) {\n        const l = this.markers_.length + 1;\n        const lat =\n          (this.center_.lat() * (l - 1) + marker.getPosition().lat()) / l;\n        const lng =\n          (this.center_.lng() * (l - 1) + marker.getPosition().lng()) / l;\n        this.center_ = new google.maps.LatLng(lat, lng);\n        this.calculateBounds_();\n      }\n    }\n\n    marker.isAdded = true;\n    this.markers_.push(marker);\n\n    const mCount = this.markers_.length;\n    const mz = this.markerClusterer_.getMaxZoom();\n    if (mz !== null && this.map_.getZoom() > mz) {\n      // Zoomed in past max zoom, so show the marker.\n      if (marker.getMap() !== this.map_) {\n        marker.setMap(this.map_);\n      }\n    } else if (mCount < this.minClusterSize_) {\n      // Min cluster size not reached so show the marker.\n      if (marker.getMap() !== this.map_) {\n        marker.setMap(this.map_);\n      }\n    } else if (mCount === this.minClusterSize_) {\n      // Hide the markers that were showing.\n      for (let i = 0; i < mCount; i++) {\n        this.markers_[i].setMap(null);\n      }\n    } else {\n      marker.setMap(null);\n    }\n\n    return true;\n  }\n\n  /**\n   * Determines if a marker lies within the cluster's bounds.\n   *\n   * @param marker The marker to check.\n   * @return True if the marker lies in the bounds.\n   * @ignore\n   */\n  public isMarkerInClusterBounds(marker: google.maps.Marker): boolean {\n    return this.bounds_.contains(marker.getPosition());\n  }\n\n  /**\n   * Calculates the extended bounds of the cluster with the grid.\n   */\n  private calculateBounds_(): void {\n    const bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n    this.bounds_ = this.markerClusterer_.getExtendedBounds(bounds);\n  }\n\n  /**\n   * Updates the cluster icon.\n   */\n  public updateIcon(): void {\n    const mCount = this.markers_.length;\n    const mz = this.markerClusterer_.getMaxZoom();\n\n    if (mz !== null && this.map_.getZoom() > mz) {\n      this.clusterIcon_.hide();\n      return;\n    }\n\n    if (mCount < this.minClusterSize_) {\n      // Min cluster size not yet reached.\n      this.clusterIcon_.hide();\n      return;\n    }\n\n    const numStyles = this.markerClusterer_.getStyles().length;\n    const sums = this.markerClusterer_.getCalculator()(\n      this.markers_,\n      numStyles\n    );\n    this.clusterIcon_.setCenter(this.center_);\n    this.clusterIcon_.useStyle(sums);\n    this.clusterIcon_.show();\n  }\n\n  /**\n   * Determines if a marker has already been added to the cluster.\n   *\n   * @param marker The marker to check.\n   * @return True if the marker has already been added.\n   */\n  private isMarkerAlreadyAdded_(marker: google.maps.Marker): boolean {\n    if (this.markers_.indexOf) {\n      return this.markers_.indexOf(marker) !== -1;\n    } else {\n      for (let i = 0; i < this.markers_.length; i++) {\n        if (marker === this.markers_[i]) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n}\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @name MarkerClustererPlus for Google Maps V3\n * @author Gary Little\n * @fileoverview\n * The library creates and manages per-zoom-level clusters for large amounts of markers.\n * <p>\n * This is an enhanced V3 implementation of the V2 MarkerClusterer by Xiaoxi Wu. It is\n * based on the V3 MarkerClusterer port by Luke Mahe. MarkerClustererPlus was created\n * by Gary Little.\n * <p>\n * v2.0 release: MarkerClustererPlus v2.0 is backward compatible with MarkerClusterer v1.0. It\n *  adds support for the `ignoreHidden`, `title`, `batchSizeIE`,\n *  and `calculator` properties as well as support for four more events. It also allows\n *  greater control over the styling of the text that appears on the cluster marker. The\n *  documentation has been significantly improved and the overall code has been simplified and\n *  polished. Very large numbers of markers can now be managed without causing Javascript timeout\n *  errors on Internet Explorer. Note that the name of the `clusterclick` event has been\n *  deprecated. The new name is `click`, so please change your application code now.\n */\n\nimport { ClusterIconInfo, ClusterIconStyle } from \"./cluster-icon\";\n\nimport { Cluster } from \"./cluster\";\nimport { OverlayViewSafe } from \"./overlay-view-safe\";\n\n/**\n * @param text The text attribute of the cluster\n */\ntype AriaLabelFn = (text: string) => string;\n\nexport type Calculator = (\n  markers: google.maps.Marker[],\n  clusterIconStylesCount: number\n) => ClusterIconInfo;\n\nexport interface ClusterAugmentedMarker extends google.maps.Marker {\n  isAdded?: boolean;\n}\n\n/**\n * This event is fired on the {@link MarkerClusterer} instance when the `MarkerClusterer` stops clustering markers.\n *\n * Example:\n * ```typescript\n *  mc.addListener('clusteringend', (mc: MarkerClusterer) => {})\n * ```\n *\n * @param mc The MarkerClusterer whose markers are being clustered.\n * @event clusteringend\n */\nexport declare function clusteringend(mc: MarkerClusterer): void;\n\n/**\n * This event is fired on the {@link MarkerClusterer} instance when the `MarkerClusterer` begins clustering markers.\n *\n * Example:\n * ```typescript\n *  mc.addListener('clusteringbegin', (mc: MarkerClusterer) => {})\n * ```\n *\n * @param mc The MarkerClusterer whose markers are being clustered.\n * @event clusteringbegin\n */\nexport declare function clusteringbegin(mc: MarkerClusterer): void;\n\n/**\n * Optional parameter passed to the {@link MarkerClusterer} constructor.\n */\nexport interface MarkerClustererOptions {\n  /**\n   * The grid size of a cluster in pixels. The grid is a square.\n   *\n   * @default `60`\n   */\n  gridSize?: number;\n  /**\n   * The maximum zoom level at which clustering is enabled or\n   * `null` if clustering is to be enabled at all zoom levels.\n   *\n   * @default `null`\n   */\n  maxZoom?: number;\n\n  /**\n   * Whether to zoom the map when a cluster marker is\n   * clicked. You may want to set this to `false` if you have installed a handler\n   * for the `click` event and it deals with zooming on its own.\n   *\n   * @default `true`\n   */\n  zoomOnClick?: boolean;\n  /***\n   * Whether the position of a cluster marker should be\n   * the average position of all markers in the cluster. If set to `false`, the\n   * cluster marker is positioned at the location of the first marker added to the cluster.\n   *\n   * @default `false`\n   */\n  averageCenter?: boolean;\n  /**\n   * The minimum number of markers needed in a cluster\n   * before the markers are hidden and a cluster marker appears.\n   *\n   * @default `2`\n   */\n  minimumClusterSize?: number;\n\n  /**\n   *  the z-index of a cluster.\n   *\n   *  @default `google.maps.Marker.MAX_ZINDEX + 1`\n   */\n  zIndex?: number;\n\n  /**\n   * Whether to ignore hidden markers in clusters. You\n   * may want to set this to `true` to ensure that hidden markers are not included\n   * in the marker count that appears on a cluster marker (this count is the value of the\n   * `text` property of the result returned by the default  {@link calculator}).\n   * If set to `true` and you change the visibility of a marker being clustered, be\n   * sure to also call {@link MarkerClusterer#repaint()}.\n   *\n   * @default `false`\n   */\n  ignoreHidden?: boolean;\n  /**\n   * The tooltip to display when the mouse moves over a cluster\n   * marker. (Alternatively, you can use a custom `calculator` function to specify a\n   * different tooltip for each cluster marker.)\n   *\n   * @default `\"\"`\n   */\n  title?: string;\n  /**\n   * The function used to determine\n   * the text to be displayed on a cluster marker and the index indicating which style to use\n   * for the cluster marker. The input parameters for the function are (1) the array of markers\n   * represented by a cluster marker and (2) the number of cluster icon styles. It returns a\n   * {@link ClusterIconInfo} object. The default `calculator` returns a\n   * `text` property which is the number of markers in the cluster and an\n   * `index` property which is one higher than the lowest integer such that\n   * `10^i` exceeds the number of markers in the cluster, or the size of the styles\n   * array, whichever is less. The `styles` array element used has an index of\n   * `index` minus 1. For example, the default `calculator` returns a\n   * `text` value of `\"125\"` and an `index` of `3`\n   * for a cluster icon representing 125 markers so the element used in the `styles`\n   * array is `2`. A `calculator` may also return a `title`\n   * property that contains the text of the tooltip to be used for the cluster marker. If\n   * `title` is not defined, the tooltip is set to the value of the `title`\n   * property for the MarkerClusterer.\n   *\n   * @default {@link MarkerClusterer.CALCULATOR}\n   */\n  calculator?: Calculator;\n  /**\n   * The name of the CSS class defining general styles\n   * for the cluster markers. Use this class to define CSS styles that are not set up by the code\n   * that processes the `styles` array.\n   *\n   * @default `\"cluster\"`\n   */\n  clusterClass?: string;\n  /**\n   * An array of {@link ClusterIconStyle} elements defining the styles\n   * of the cluster markers to be used. The element to be used to style a given cluster marker\n   * is determined by the function defined by the `calculator` property.\n   * The default is an array of {@link ClusterIconStyle} elements whose properties are derived\n   * from the values for `imagePath`, `imageExtension`, and `imageSizes`.\n   *\n   * @default `styles`\n   */\n  styles?: ClusterIconStyle[];\n  /**\n   * Whether to allow the use of cluster icons that\n   * have sizes that are some multiple (typically double) of their actual display size. Icons such\n   * as these look better when viewed on high-resolution monitors such as Apple's Retina displays.\n   * Note: if this property is `true`, sprites cannot be used as cluster icons.\n   *\n   * @default `false`\n   */\n  enableRetinaIcons?: boolean;\n  /**\n   * Set this property to the number of markers to be processed in a single batch when using\n   * a browser other than Internet Explorer (for Internet Explorer, use the batchSizeIE property instead).\n   *\n   * @default `MarkerClusterer.BATCH_SIZE`\n   */\n  batchSize?: number;\n  /**\n   * When Internet Explorer is\n   * being used, markers are processed in several batches with a small delay inserted between\n   * each batch in an attempt to avoid Javascript timeout errors. Set this property to the\n   * number of markers to be processed in a single batch; select as high a number as you can\n   * without causing a timeout error in the browser. This number might need to be as low as 100\n   * if 15,000 markers are being managed, for example.\n   *\n   * @default `MarkerClusterer.BATCH_SIZE_IE`\n   */\n  batchSizeIE?: number;\n  /**\n   * The full URL of the root name of the group of image files to use for cluster icons.\n   * The complete file name is of the form `imagePath`n.`imageExtension`\n   * where n is the image file number (1, 2, etc.).\n   *\n   * @default `MarkerClusterer.IMAGE_PATH`\n   */\n  imagePath?: string;\n  /**\n   * The extension name for the cluster icon image files (e.g., `\"png\"` or\n   * `\"jpg\"`).\n   *\n   * @default `MarkerClusterer.IMAGE_EXTENSION`\n   */\n  imageExtension?: string;\n  /**\n   * An array of numbers containing the widths of the group of\n   * `imagePath`n.`imageExtension` image files.\n   * (The images are assumed to be square.)\n   *\n   * @default `MarkerClusterer.IMAGE_SIZES`\n   */\n  imageSizes?: number[];\n  /**\n   * A function to take the text attribute associated with the cluster and output a string to attach an\n   * ariaLabel to the cluster\n   */\n  ariaLabelFn?: AriaLabelFn;\n}\n\n/**\n * @ignore\n */\nconst getOption = <T, K extends keyof T>(\n  options: T,\n  prop: K,\n  def: T[K]\n): T[K] => {\n  if (options[prop] !== undefined) {\n    return options[prop];\n  } else {\n    return def;\n  }\n};\n\nexport class MarkerClusterer extends OverlayViewSafe {\n  /**\n   * The number of markers to process in one batch.\n   */\n  static BATCH_SIZE = 2000;\n\n  /**\n   * The number of markers to process in one batch (IE only).\n   */\n  static BATCH_SIZE_IE = 500;\n\n  /**\n   * The default root name for the marker cluster images.\n   */\n  static IMAGE_PATH = \"../images/m\";\n\n  /**\n   * The default extension name for the marker cluster images.\n   */\n  static IMAGE_EXTENSION = \"png\";\n\n  /**\n   * The default array of sizes for the marker cluster images.\n   */\n  static IMAGE_SIZES: number[] = [53, 56, 66, 78, 90];\n\n  private markers_: ClusterAugmentedMarker[] = [];\n  private clusters_: Cluster[] = [];\n  private listeners_: google.maps.MapsEventListener[] = [];\n\n  private activeMap_: google.maps.Map = null;\n  private ready_ = false;\n\n  public ariaLabelFn = this.options.ariaLabelFn || ((): string => \"\");\n\n  private zIndex_ = this.options.zIndex || google.maps.Marker.MAX_ZINDEX + 1;\n  private gridSize_ = this.options.gridSize || 60;\n  private minClusterSize_ = this.options.minimumClusterSize || 2;\n  private maxZoom_ = this.options.maxZoom || null;\n  private styles_: ClusterIconStyle[] = this.options.styles || [];\n  private title_ = this.options.title || \"\";\n\n  private zoomOnClick_ = getOption(this.options, \"zoomOnClick\", true);\n  private averageCenter_ = getOption(this.options, \"averageCenter\", false);\n\n  private ignoreHidden_ = getOption(this.options, \"ignoreHidden\", false);\n  private enableRetinaIcons_ = getOption(\n    this.options,\n    \"enableRetinaIcons\",\n    false\n  );\n\n  private imagePath_ = this.options.imagePath || MarkerClusterer.IMAGE_PATH;\n  private imageExtension_ =\n    this.options.imageExtension || MarkerClusterer.IMAGE_EXTENSION;\n  private imageSizes_ = this.options.imageSizes || MarkerClusterer.IMAGE_SIZES;\n  private calculator_ = this.options.calculator || MarkerClusterer.CALCULATOR;\n  private batchSize_ = this.options.batchSize || MarkerClusterer.BATCH_SIZE;\n  private batchSizeIE_ =\n    this.options.batchSizeIE || MarkerClusterer.BATCH_SIZE_IE;\n  private clusterClass_ = this.options.clusterClass || \"cluster\";\n\n  private prevZoom_: number;\n  private timerRefStatic: number;\n\n  /**\n   * Creates a MarkerClusterer object with the options specified in {@link MarkerClustererOptions}.\n   * @param map The Google map to attach to.\n   * @param markers The markers to be added to the cluster.\n   * @param options The optional parameters.\n   */\n  constructor(\n    map: google.maps.Map,\n    markers: google.maps.Marker[] = [],\n    private options: MarkerClustererOptions = {}\n  ) {\n    super();\n\n    if (navigator.userAgent.toLowerCase().indexOf(\"msie\") !== -1) {\n      // Try to avoid IE timeout when processing a huge number of markers:\n      this.batchSize_ = this.batchSizeIE_;\n    }\n\n    this.setupStyles_();\n\n    this.addMarkers(markers, true);\n    this.setMap(map); // Note: this causes onAdd to be called\n  }\n\n  /**\n   * Implementation of the onAdd interface method.\n   * @ignore\n   */\n  onAdd(): void {\n    this.activeMap_ = this.getMap() as google.maps.Map;\n    this.ready_ = true;\n\n    this.repaint();\n\n    this.prevZoom_ = this.getMap().getZoom();\n\n    // Add the map event listeners\n    this.listeners_ = [\n      google.maps.event.addListener(this.getMap(), \"zoom_changed\", () => {\n        const map: google.maps.Map & {\n          minZoom: number;\n          maxZoom: number;\n          mapTypes: { [type: string]: google.maps.MapType };\n        } = this.getMap() as any; // eslint-disable-line @typescript-eslint/no-explicit-any\n\n        // Fix for bug #407\n        // Determines map type and prevents illegal zoom levels\n        const minZoom = map.minZoom || 0;\n        const maxZoom = Math.min(\n          map.maxZoom || 100,\n          map.mapTypes[map.getMapTypeId()].maxZoom\n        );\n        const zoom = Math.min(\n          Math.max(this.getMap().getZoom(), minZoom),\n          maxZoom\n        );\n\n        if (this.prevZoom_ != zoom) {\n          this.prevZoom_ = zoom;\n          this.resetViewport_(false);\n        }\n      }),\n      google.maps.event.addListener(this.getMap(), \"idle\", () => {\n        this.redraw_();\n      })\n    ];\n  }\n\n  /**\n   * Implementation of the onRemove interface method.\n   * Removes map event listeners and all cluster icons from the DOM.\n   * All managed markers are also put back on the map.\n   * @ignore\n   */\n  onRemove(): void {\n    // Put all the managed markers back on the map:\n    for (let i = 0; i < this.markers_.length; i++) {\n      if (this.markers_[i].getMap() !== this.activeMap_) {\n        this.markers_[i].setMap(this.activeMap_);\n      }\n    }\n\n    // Remove all clusters:\n    for (let i = 0; i < this.clusters_.length; i++) {\n      this.clusters_[i].remove();\n    }\n    this.clusters_ = [];\n\n    // Remove map event listeners:\n    for (let i = 0; i < this.listeners_.length; i++) {\n      google.maps.event.removeListener(this.listeners_[i]);\n    }\n    this.listeners_ = [];\n\n    this.activeMap_ = null;\n    this.ready_ = false;\n  }\n\n  /**\n   * Implementation of the draw interface method.\n   * @ignore\n   */\n  draw(): void {}\n\n  /**\n   * Sets up the styles object.\n   */\n  private setupStyles_(): void {\n    if (this.styles_.length > 0) {\n      return;\n    }\n\n    for (let i = 0; i < this.imageSizes_.length; i++) {\n      const size = this.imageSizes_[i];\n      this.styles_.push(\n        MarkerClusterer.withDefaultStyle({\n          url: this.imagePath_ + (i + 1) + \".\" + this.imageExtension_,\n          height: size,\n          width: size\n        })\n      );\n    }\n  }\n\n  /**\n   *  Fits the map to the bounds of the markers managed by the clusterer.\n   */\n  fitMapToMarkers(padding: number | google.maps.Padding): void {\n    const markers = this.getMarkers();\n    const bounds = new google.maps.LatLngBounds();\n    for (let i = 0; i < markers.length; i++) {\n      // March 3, 2018: Bug fix -- honor the ignoreHidden property\n      if (markers[i].getVisible() || !this.getIgnoreHidden()) {\n        bounds.extend(markers[i].getPosition());\n      }\n    }\n\n    (this.getMap() as google.maps.Map).fitBounds(bounds, padding);\n  }\n\n  /**\n   * Returns the value of the `gridSize` property.\n   *\n   * @return The grid size.\n   */\n  getGridSize(): number {\n    return this.gridSize_;\n  }\n\n  /**\n   * Sets the value of the `gridSize` property.\n   *\n   * @param gridSize The grid size.\n   */\n  setGridSize(gridSize: number): void {\n    this.gridSize_ = gridSize;\n  }\n\n  /**\n   * Returns the value of the `minimumClusterSize` property.\n   *\n   * @return The minimum cluster size.\n   */\n  getMinimumClusterSize(): number {\n    return this.minClusterSize_;\n  }\n\n  /**\n   * Sets the value of the `minimumClusterSize` property.\n   *\n   * @param minimumClusterSize The minimum cluster size.\n   */\n  setMinimumClusterSize(minimumClusterSize: number): void {\n    this.minClusterSize_ = minimumClusterSize;\n  }\n\n  /**\n   *  Returns the value of the `maxZoom` property.\n   *\n   *  @return The maximum zoom level.\n   */\n  getMaxZoom(): number {\n    return this.maxZoom_;\n  }\n\n  /**\n   *  Sets the value of the `maxZoom` property.\n   *\n   *  @param maxZoom The maximum zoom level.\n   */\n  setMaxZoom(maxZoom: number): void {\n    this.maxZoom_ = maxZoom;\n  }\n\n  getZIndex(): number {\n    return this.zIndex_;\n  }\n\n  setZIndex(zIndex: number): void {\n    this.zIndex_ = zIndex;\n  }\n\n  /**\n   *  Returns the value of the `styles` property.\n   *\n   *  @return The array of styles defining the cluster markers to be used.\n   */\n  getStyles(): ClusterIconStyle[] {\n    return this.styles_;\n  }\n\n  /**\n   *  Sets the value of the `styles` property.\n   *\n   *  @param styles The array of styles to use.\n   */\n  setStyles(styles: ClusterIconStyle[]): void {\n    this.styles_ = styles;\n  }\n\n  /**\n   * Returns the value of the `title` property.\n   *\n   * @return The content of the title text.\n   */\n  getTitle(): string {\n    return this.title_;\n  }\n\n  /**\n   *  Sets the value of the `title` property.\n   *\n   *  @param title The value of the title property.\n   */\n  setTitle(title: string): void {\n    this.title_ = title;\n  }\n\n  /**\n   * Returns the value of the `zoomOnClick` property.\n   *\n   * @return True if zoomOnClick property is set.\n   */\n  getZoomOnClick(): boolean {\n    return this.zoomOnClick_;\n  }\n\n  /**\n   *  Sets the value of the `zoomOnClick` property.\n   *\n   *  @param zoomOnClick The value of the zoomOnClick property.\n   */\n  setZoomOnClick(zoomOnClick: boolean): void {\n    this.zoomOnClick_ = zoomOnClick;\n  }\n\n  /**\n   * Returns the value of the `averageCenter` property.\n   *\n   * @return True if averageCenter property is set.\n   */\n  getAverageCenter(): boolean {\n    return this.averageCenter_;\n  }\n\n  /**\n   *  Sets the value of the `averageCenter` property.\n   *\n   *  @param averageCenter The value of the averageCenter property.\n   */\n  setAverageCenter(averageCenter: boolean): void {\n    this.averageCenter_ = averageCenter;\n  }\n\n  /**\n   * Returns the value of the `ignoreHidden` property.\n   *\n   * @return True if ignoreHidden property is set.\n   */\n  getIgnoreHidden(): boolean {\n    return this.ignoreHidden_;\n  }\n\n  /**\n   *  Sets the value of the `ignoreHidden` property.\n   *\n   *  @param ignoreHidden The value of the ignoreHidden property.\n   */\n  setIgnoreHidden(ignoreHidden: boolean): void {\n    this.ignoreHidden_ = ignoreHidden;\n  }\n\n  /**\n   * Returns the value of the `enableRetinaIcons` property.\n   *\n   * @return True if enableRetinaIcons property is set.\n   */\n  getEnableRetinaIcons(): boolean {\n    return this.enableRetinaIcons_;\n  }\n\n  /**\n   *  Sets the value of the `enableRetinaIcons` property.\n   *\n   *  @param enableRetinaIcons The value of the enableRetinaIcons property.\n   */\n  setEnableRetinaIcons(enableRetinaIcons: boolean): void {\n    this.enableRetinaIcons_ = enableRetinaIcons;\n  }\n\n  /**\n   * Returns the value of the `imageExtension` property.\n   *\n   * @return The value of the imageExtension property.\n   */\n  getImageExtension(): string {\n    return this.imageExtension_;\n  }\n\n  /**\n   *  Sets the value of the `imageExtension` property.\n   *\n   *  @param imageExtension The value of the imageExtension property.\n   */\n  setImageExtension(imageExtension: string): void {\n    this.imageExtension_ = imageExtension;\n  }\n\n  /**\n   * Returns the value of the `imagePath` property.\n   *\n   * @return The value of the imagePath property.\n   */\n  getImagePath(): string {\n    return this.imagePath_;\n  }\n\n  /**\n   *  Sets the value of the `imagePath` property.\n   *\n   *  @param imagePath The value of the imagePath property.\n   */\n  setImagePath(imagePath: string): void {\n    this.imagePath_ = imagePath;\n  }\n\n  /**\n   * Returns the value of the `imageSizes` property.\n   *\n   * @return The value of the imageSizes property.\n   */\n  getImageSizes(): number[] {\n    return this.imageSizes_;\n  }\n\n  /**\n   *  Sets the value of the `imageSizes` property.\n   *\n   *  @param imageSizes The value of the imageSizes property.\n   */\n  setImageSizes(imageSizes: number[]): void {\n    this.imageSizes_ = imageSizes;\n  }\n\n  /**\n   * Returns the value of the `calculator` property.\n   *\n   * @return the value of the calculator property.\n   */\n  getCalculator(): Calculator {\n    return this.calculator_;\n  }\n\n  /**\n   * Sets the value of the `calculator` property.\n   *\n   * @param calculator The value of the calculator property.\n   */\n  setCalculator(calculator: Calculator): void {\n    this.calculator_ = calculator;\n  }\n\n  /**\n   * Returns the value of the `batchSizeIE` property.\n   *\n   * @return the value of the batchSizeIE property.\n   */\n  getBatchSizeIE(): number {\n    return this.batchSizeIE_;\n  }\n\n  /**\n   * Sets the value of the `batchSizeIE` property.\n   *\n   *  @param batchSizeIE The value of the batchSizeIE property.\n   */\n  setBatchSizeIE(batchSizeIE: number): void {\n    this.batchSizeIE_ = batchSizeIE;\n  }\n\n  /**\n   * Returns the value of the `clusterClass` property.\n   *\n   * @return the value of the clusterClass property.\n   */\n  getClusterClass(): string {\n    return this.clusterClass_;\n  }\n\n  /**\n   * Sets the value of the `clusterClass` property.\n   *\n   *  @param clusterClass The value of the clusterClass property.\n   */\n  setClusterClass(clusterClass: string): void {\n    this.clusterClass_ = clusterClass;\n  }\n\n  /**\n   *  Returns the array of markers managed by the clusterer.\n   *\n   *  @return The array of markers managed by the clusterer.\n   */\n  getMarkers(): google.maps.Marker[] {\n    return this.markers_;\n  }\n\n  /**\n   *  Returns the number of markers managed by the clusterer.\n   *\n   *  @return The number of markers.\n   */\n  getTotalMarkers(): number {\n    return this.markers_.length;\n  }\n\n  /**\n   * Returns the current array of clusters formed by the clusterer.\n   *\n   * @return The array of clusters formed by the clusterer.\n   */\n  getClusters(): Cluster[] {\n    return this.clusters_;\n  }\n\n  /**\n   * Returns the number of clusters formed by the clusterer.\n   *\n   * @return The number of clusters formed by the clusterer.\n   */\n  getTotalClusters(): number {\n    return this.clusters_.length;\n  }\n\n  /**\n   * Adds a marker to the clusterer. The clusters are redrawn unless\n   *  `nodraw` is set to `true`.\n   *\n   * @param marker The marker to add.\n   * @param nodraw Set to `true` to prevent redrawing.\n   */\n  addMarker(marker: google.maps.Marker, nodraw?: boolean): void {\n    this.pushMarkerTo_(marker);\n    if (!nodraw) {\n      this.redraw_();\n    }\n  }\n\n  /**\n   * Adds an array of markers to the clusterer. The clusters are redrawn unless\n   *  `nodraw` is set to `true`.\n   *\n   * @param markers The markers to add.\n   * @param nodraw Set to `true` to prevent redrawing.\n   */\n  addMarkers(markers: google.maps.Marker[], nodraw?: boolean): void {\n    for (const key in markers) {\n      if (Object.prototype.hasOwnProperty.call(markers, key)) {\n        this.pushMarkerTo_(markers[key]);\n      }\n    }\n    if (!nodraw) {\n      this.redraw_();\n    }\n  }\n\n  /**\n   * Pushes a marker to the clusterer.\n   *\n   * @param marker The marker to add.\n   */\n  private pushMarkerTo_(\n    marker: google.maps.Marker & { isAdded?: boolean }\n  ): void {\n    // If the marker is draggable add a listener so we can update the clusters on the dragend:\n    if (marker.getDraggable()) {\n      google.maps.event.addListener(marker, \"dragend\", () => {\n        if (this.ready_) {\n          marker.isAdded = false;\n          this.repaint();\n        }\n      });\n    }\n    marker.isAdded = false;\n    this.markers_.push(marker);\n  }\n\n  /**\n   * Removes a marker from the cluster.  The clusters are redrawn unless\n   *  `nodraw` is set to `true`. Returns `true` if the\n   *  marker was removed from the clusterer.\n   *\n   * @param marker The marker to remove.\n   * @param nodraw Set to `true` to prevent redrawing.\n   * @return True if the marker was removed from the clusterer.\n   */\n  removeMarker(marker: google.maps.Marker, nodraw?: boolean): boolean {\n    const removed = this.removeMarker_(marker);\n\n    if (!nodraw && removed) {\n      this.repaint();\n    }\n\n    return removed;\n  }\n\n  /**\n   * Removes an array of markers from the cluster. The clusters are redrawn unless\n   *  `nodraw` is set to `true`. Returns `true` if markers were removed from the clusterer.\n   *\n   * @param markers The markers to remove.\n   * @param nodraw Set to `true` to prevent redrawing.\n   * @return True if markers were removed from the clusterer.\n   */\n  removeMarkers(markers: google.maps.Marker[], nodraw?: boolean): boolean {\n    let removed = false;\n\n    for (let i = 0; i < markers.length; i++) {\n      const r = this.removeMarker_(markers[i]);\n      removed = removed || r;\n    }\n\n    if (!nodraw && removed) {\n      this.repaint();\n    }\n\n    return removed;\n  }\n\n  /**\n   * Removes a marker and returns true if removed, false if not.\n   *\n   * @param marker The marker to remove\n   * @return Whether the marker was removed or not\n   */\n  private removeMarker_(marker: google.maps.Marker): boolean {\n    let index = -1;\n    if (this.markers_.indexOf) {\n      index = this.markers_.indexOf(marker);\n    } else {\n      for (let i = 0; i < this.markers_.length; i++) {\n        if (marker === this.markers_[i]) {\n          index = i;\n          break;\n        }\n      }\n    }\n\n    if (index === -1) {\n      // Marker is not in our list of markers, so do nothing:\n      return false;\n    }\n\n    marker.setMap(null);\n    this.markers_.splice(index, 1); // Remove the marker from the list of managed markers\n    return true;\n  }\n\n  /**\n   * Removes all clusters and markers from the map and also removes all markers\n   *  managed by the clusterer.\n   */\n  clearMarkers(): void {\n    this.resetViewport_(true);\n    this.markers_ = [];\n  }\n\n  /**\n   * Recalculates and redraws all the marker clusters from scratch.\n   *  Call this after changing any properties.\n   */\n  repaint(): void {\n    const oldClusters = this.clusters_.slice();\n    this.clusters_ = [];\n    this.resetViewport_(false);\n    this.redraw_();\n\n    // Remove the old clusters.\n    // Do it in a timeout to prevent blinking effect.\n    setTimeout(function() {\n      for (let i = 0; i < oldClusters.length; i++) {\n        oldClusters[i].remove();\n      }\n    }, 0);\n  }\n\n  /**\n   * Returns the current bounds extended by the grid size.\n   *\n   * @param bounds The bounds to extend.\n   * @return The extended bounds.\n   * @ignore\n   */\n  getExtendedBounds(\n    bounds: google.maps.LatLngBounds\n  ): google.maps.LatLngBounds {\n    const projection = this.getProjection();\n\n    // Turn the bounds into latlng.\n    const tr = new google.maps.LatLng(\n      bounds.getNorthEast().lat(),\n      bounds.getNorthEast().lng()\n    );\n    const bl = new google.maps.LatLng(\n      bounds.getSouthWest().lat(),\n      bounds.getSouthWest().lng()\n    );\n\n    // Convert the points to pixels and the extend out by the grid size.\n    const trPix = projection.fromLatLngToDivPixel(tr);\n    trPix.x += this.gridSize_;\n    trPix.y -= this.gridSize_;\n\n    const blPix = projection.fromLatLngToDivPixel(bl);\n    blPix.x -= this.gridSize_;\n    blPix.y += this.gridSize_;\n\n    // Convert the pixel points back to LatLng\n    const ne = projection.fromDivPixelToLatLng(trPix);\n    const sw = projection.fromDivPixelToLatLng(blPix);\n\n    // Extend the bounds to contain the new bounds.\n    bounds.extend(ne);\n    bounds.extend(sw);\n\n    return bounds;\n  }\n\n  /**\n   * Redraws all the clusters.\n   */\n  private redraw_(): void {\n    this.createClusters_(0);\n  }\n\n  /**\n   * Removes all clusters from the map. The markers are also removed from the map\n   *  if `hide` is set to `true`.\n   *\n   * @param hide Set to `true` to also remove the markers from the map.\n   */\n  private resetViewport_(hide?: boolean): void {\n    // Remove all the clusters\n    for (let i = 0; i < this.clusters_.length; i++) {\n      this.clusters_[i].remove();\n    }\n    this.clusters_ = [];\n\n    // Reset the markers to not be added and to be removed from the map.\n    for (let i = 0; i < this.markers_.length; i++) {\n      const marker = this.markers_[i];\n      marker.isAdded = false;\n      if (hide) {\n        marker.setMap(null);\n      }\n    }\n  }\n\n  /**\n   * Calculates the distance between two latlng locations in km.\n   *\n   * @param p1 The first lat lng point.\n   * @param p2 The second lat lng point.\n   * @return The distance between the two points in km.\n   * @link http://www.movable-type.co.uk/scripts/latlong.html\n   */\n  private distanceBetweenPoints_(\n    p1: google.maps.LatLng,\n    p2: google.maps.LatLng\n  ): number {\n    const R = 6371; // Radius of the Earth in km\n    const dLat = ((p2.lat() - p1.lat()) * Math.PI) / 180;\n    const dLon = ((p2.lng() - p1.lng()) * Math.PI) / 180;\n    const a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.cos((p1.lat() * Math.PI) / 180) *\n        Math.cos((p2.lat() * Math.PI) / 180) *\n        Math.sin(dLon / 2) *\n        Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  }\n\n  /**\n   * Determines if a marker is contained in a bounds.\n   *\n   * @param marker The marker to check.\n   * @param bounds The bounds to check against.\n   * @return True if the marker is in the bounds.\n   */\n  private isMarkerInBounds_(\n    marker: google.maps.Marker,\n    bounds: google.maps.LatLngBounds\n  ): boolean {\n    return bounds.contains(marker.getPosition());\n  }\n\n  /**\n   * Adds a marker to a cluster, or creates a new cluster.\n   *\n   * @param marker The marker to add.\n   */\n  private addToClosestCluster_(marker: google.maps.Marker): void {\n    let distance = 40000; // Some large number\n    let clusterToAddTo = null;\n    for (let i = 0; i < this.clusters_.length; i++) {\n      const cluster = this.clusters_[i];\n      const center = cluster.getCenter();\n      if (center) {\n        const d = this.distanceBetweenPoints_(center, marker.getPosition());\n        if (d < distance) {\n          distance = d;\n          clusterToAddTo = cluster;\n        }\n      }\n    }\n\n    if (clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker)) {\n      clusterToAddTo.addMarker(marker);\n    } else {\n      const cluster = new Cluster(this);\n      cluster.addMarker(marker);\n      this.clusters_.push(cluster);\n    }\n  }\n\n  /**\n   * Creates the clusters. This is done in batches to avoid timeout errors\n   *  in some browsers when there is a huge number of markers.\n   *\n   * @param iFirst The index of the first marker in the batch of\n   *  markers to be added to clusters.\n   */\n  private createClusters_(iFirst: number): void {\n    if (!this.ready_) {\n      return;\n    }\n\n    // Cancel previous batch processing if we're working on the first batch:\n    if (iFirst === 0) {\n      google.maps.event.trigger(this, \"clusteringbegin\", this);\n\n      if (typeof this.timerRefStatic !== \"undefined\") {\n        clearTimeout(this.timerRefStatic);\n        delete this.timerRefStatic;\n      }\n    }\n\n    // Get our current map view bounds.\n    // Create a new bounds object so we don't affect the map.\n    //\n    // See Comments 9 & 11 on Issue 3651 relating to this workaround for a Google Maps bug:\n    let mapBounds: google.maps.LatLngBounds;\n\n    if (this.getMap().getZoom() > 3) {\n      mapBounds = new google.maps.LatLngBounds(\n        (this.getMap() as google.maps.Map).getBounds().getSouthWest(),\n        (this.getMap() as google.maps.Map).getBounds().getNorthEast()\n      );\n    } else {\n      mapBounds = new google.maps.LatLngBounds(\n        new google.maps.LatLng(85.02070771743472, -178.48388434375),\n        new google.maps.LatLng(-85.08136444384544, 178.00048865625)\n      );\n    }\n    const bounds = this.getExtendedBounds(mapBounds);\n\n    const iLast = Math.min(iFirst + this.batchSize_, this.markers_.length);\n\n    for (let i = iFirst; i < iLast; i++) {\n      const marker = this.markers_[i];\n      if (!marker.isAdded && this.isMarkerInBounds_(marker, bounds)) {\n        if (\n          !this.ignoreHidden_ ||\n          (this.ignoreHidden_ && marker.getVisible())\n        ) {\n          this.addToClosestCluster_(marker);\n        }\n      }\n    }\n\n    if (iLast < this.markers_.length) {\n      this.timerRefStatic = window.setTimeout(() => {\n        this.createClusters_(iLast);\n      }, 0);\n    } else {\n      delete this.timerRefStatic;\n      google.maps.event.trigger(this, \"clusteringend\", this);\n\n      for (let i = 0; i < this.clusters_.length; i++) {\n        this.clusters_[i].updateIcon();\n      }\n    }\n  }\n\n  /**\n   * The default function for determining the label text and style\n   * for a cluster icon.\n   *\n   * @param markers The array of markers represented by the cluster.\n   * @param numStyles The number of marker styles available.\n   * @return The information resource for the cluster.\n   */\n  static CALCULATOR(\n    markers: google.maps.Marker[],\n    numStyles: number\n  ): ClusterIconInfo {\n    let index = 0;\n    const count: number = markers.length;\n\n    let dv = count;\n    while (dv !== 0) {\n      dv = Math.floor(dv / 10);\n      index++;\n    }\n\n    index = Math.min(index, numStyles);\n    return {\n      text: count.toString(),\n      index: index,\n      title: \"\"\n    };\n  }\n\n  /**\n   * Generates default styles augmented with user passed values.\n   * Useful when you want to override some default values but keep untouched\n   *\n   * @param overrides override default values\n   */\n  static withDefaultStyle(overrides: ClusterIconStyle): ClusterIconStyle {\n    return {\n      textColor: \"black\",\n      textSize: 11,\n      textDecoration: \"none\",\n      textLineHeight: overrides.height,\n      fontWeight: \"bold\",\n      fontStyle: \"normal\",\n      fontFamily: \"Arial,sans-serif\",\n      backgroundPosition: \"0 0\",\n      ...overrides\n    };\n  }\n}\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MarkerClusterer } from \"./markerclusterer\";\n\nexport { ClusterIconInfo, ClusterIconStyle } from \"./cluster-icon\";\nexport { MarkerClustererOptions } from \"./markerclusterer\";\n\nexport default MarkerClusterer;\n"],"names":[],"mappings":"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"}